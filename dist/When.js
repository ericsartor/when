!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.when=t():e.when=t()}(self,(()=>(()=>{"use strict";var e={807:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isEdgeChromium=t.isChrome=t.isEdge=t.isIE=t.isSafari=t.isFirefox=t.isOpera=void 0,t.isOpera=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t.isFirefox="undefined"!=typeof InstallTrigger,t.isSafari=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),t.isIE=!!document.documentMode,t.isEdge=!t.isIE&&!!window.StyleMedia,t.isChrome=!(!window.chrome||!window.chrome.webstore&&!window.chrome.runtime),t.isEdgeChromium=t.isChrome&&-1!=navigator.userAgent.indexOf("Edg")},472:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Shortcut=void 0;var i=n(721),r=n(114),s=n(563),o=n(85),a=n(664),u=n(780);t.Shortcut=function(){function e(t){var n=t.timeline,s=t.command,o=t.handler,c=t.mode,d=t.once,l=t.inInput,h=t.timeConstraint,f=t.focusTarget;this.lastTriggeredEventId=null,this.active=!0,this.preventDefault=!0,this.once=!1,this.inInput=!1,this.timeConstraint=null,this.focusTarget=null,this.id=e.idCounter++,e.map.set(this.id,this),this.timeline=n,this.command=s,this.handler=o,this.mode=c,this.once=d||this.once,this.inInput=l||this.inInput,this.timeConstraint=h||this.timeConstraint,this.focusTarget=f||this.focusTarget,this.combination=(0,a.createCombinationString)(this),this.keys=this.timeline.map((function(e){return e.identifier})),this.timeline.forEach((function(e){var t=(0,r.generateEventKeyString)(e);if(i.preventDefaultShortcuts.has(t)){var n=i.preventDefaultShortcuts.get(t);i.preventDefaultShortcuts.set(t,n+1)}else i.preventDefaultShortcuts.set(t,1)})),(0,u.addDocumentedShortcut)(this)}return e.prototype.remove=function(){e.map.delete(this.id),this.preventDefault&&this.timeline.forEach((function(e){var t=(0,r.generateEventKeyString)(e);if(i.preventDefaultShortcuts.has(t)){var n=i.preventDefaultShortcuts.get(t);i.preventDefaultShortcuts.set(t,n-1)}}))},e.prototype.pause=function(){this.active=!1},e.prototype.unpause=function(){this.active=!0},e.prototype.toggle=function(){this.active=!this.active},e.prototype.trigger=function(){if(this.handler)this.handler(void 0);else if(this.command){if("function"!=typeof s.commands[this.command])throw new o.WhenError('command "'.concat(this.command,"\" hasn't been been registered as a ")+"function with When([command_name]).Run([function])");s.commands[this.command](void 0)}},e.prototype.Once=function(){return this.once=!0,this},e.prototype.InInput=function(){return this.inInput=!0,this},e.prototype.AllowDefault=function(){return this.timeline.forEach((function(e){var t=(0,r.generateEventKeyString)(e);if(i.preventDefaultShortcuts.has(t)){var n=i.preventDefaultShortcuts.get(t);i.preventDefaultShortcuts.set(t,n-1)}})),this.preventDefault=!1,this},e.idCounter=0,e.map=new Map,e}()},721:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkPreventDefault=t.preventDefaultShortcuts=void 0;var i=n(114),r=n(738);t.preventDefaultShortcuts=new Map,t.checkPreventDefault=function(e,n){var s=(0,r.getActiveElement)();if(s){var o=["textarea","input","select"];if(["Enter","NumpadEnter","Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Escape"].includes(e.key)&&o.push("button"),o.includes(s.tagName.toLowerCase()))return}var a=(0,i.generateEventKeyString)(e);t.preventDefaultShortcuts.has(a)&&t.preventDefaultShortcuts.get(a)>0&&n.preventDefault()}},780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.documentation=t.addDocumentedShortcut=t.documentedShortcuts=void 0,t.documentedShortcuts=[];var n={};t.addDocumentedShortcut=function(e){var i,r=null===(i=e.focusTarget||"")||void 0===i?void 0:i.toString(),s=e.mode||"";n[e.combination]&&n[e.combination][r]&&n[e.combination][r][s]||(n[e.combination]={}||n[e.combination],n[e.combination][r]={}||n[e.combination][r],n[e.combination][r][s]=!0,t.documentedShortcuts.push(e))},t.documentation=function(){var e=[];return t.documentedShortcuts.forEach((function(t){e.push({mode:t.mode||"",combination:t.combination,command:t.command?t.command:t.handler?"anon func":""})})),e}},242:function(e,t,n){var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)},r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,r=0,s=t.length;r<s;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.emitEvent=t.addNewEvent=t.eventHistory=void 0;var s=n(85),o=n(472),a=n(563),u=n(721),c=n(761),d=n(296),l=n(86),h=n(892),f=n(383),m=n(738),p=0;t.eventHistory=[],t.addNewEvent=function(e){var n=p++;t.eventHistory.push(i(i({},e),{id:n}))};var y=null,v=null;t.emitEvent=function(e){void 0!==e&&(0,t.addNewEvent)(e),o.Shortcut.map.forEach((function(n){if(n.active&&(!n.mode||f.currentMode===n.mode)&&(0,h.shortcutFocusIsFulfilled)(n)){var i=(0,m.getActiveElement)(),o=["textarea","input","select"];if(e&&["Enter","NumpadEnter","Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Escape"].includes(e.key)&&o.push("button"),n.inInput||!i||!o.includes(i.tagName.toLowerCase())){for(var u=!1,c=r([],n.timeline,!0),p=[],w=0;w<t.eventHistory.length&&p.length!==n.timeline.length;w++){var g=c[c.length-1],E=t.eventHistory[t.eventHistory.length-1-w];if(n.lastTriggeredEventId===E.id){u=!0;break}if(0===w){if(!(0,l.checkEventMatch)(g,E)){u=!0;break}p.unshift(E),c.pop()}else{var b=p[p.length-1].timestamp-E.timestamp;if(null!==n.timeConstraint&&n.timeConstraint>0&&b>n.timeConstraint){u=!0;break}var k=E.type===g.type;if(k&&(0,l.checkEventMatch)(g,E)){p.unshift(E),c.pop();continue}if(k){u=!0;break}}}if(!u&&p.length===n.timeline.length){if(null!==n.timeConstraint&&n.timeConstraint>0){var I=p[0],W=p[p.length-1];if(void 0!==W&&void 0!==I&&W.timestamp-I.timestamp>n.timeConstraint&&(u=!0),u)return}var _=p[p.length-1],C=_.type,F="released"===C?v:y,S={event:F,alt:F.altKey,ctrl:F.ctrlKey,shift:F.shiftKey,meta:F.metaKey,shortcut:n,keys:n.keys,focusedElement:d.focusedElement,pressDuration:"held"===C?_.duration:void 0};if(n.handler)n.handler(S);else if(n.command){if("function"!=typeof a.commands[n.command])throw new s.WhenError('command "'.concat(n.command,"\" hasn't been been registered as a ")+"function with When([command_name]).Run([function])");a.commands[n.command](S)}n.once&&n.remove(),n.lastTriggeredEventId=p[p.length-1].id}}}}))},window.addEventListener("keydown",(function(e){if(a.shouldCheckEvents&&null!==c.keys&&null!==c.modifierKeys){var n={type:"pressed",key:e.code,identifier:"",rawIdentifier:"",timestamp:performance.now(),modifiers:{shift:e.shiftKey,alt:e.altKey,ctrl:e.ctrlKey,meta:e.metaKey}};(0,u.checkPreventDefault)(n,e),!0!==c.keyStatus[e.code].pressed&&(c.modifierKeys.includes(e.code)||(y=e,(0,t.emitEvent)(n)),c.keyStatus[e.code].pressed=!0,c.keyStatus[e.code].timestamp=performance.now())}})),window.addEventListener("keyup",(function(e){if(a.shouldCheckEvents&&null!==c.keys&&null!==c.modifierKeys&&!1!==c.keyStatus[e.code].pressed)if(c.modifierKeys.includes(e.code))c.keyStatus[e.code].pressed=!1,c.keyStatus[e.code].timestamp=null;else{var n={type:"released",key:e.code,identifier:"",rawIdentifier:"",timestamp:performance.now(),modifiers:{shift:e.shiftKey,alt:e.altKey,ctrl:e.ctrlKey,meta:e.metaKey}};v=e,(0,t.emitEvent)(n),c.keyStatus[e.code].pressed=!1,c.keyStatus[e.code].timestamp=null}})),function e(){if(null===c.keys)throw new s.WhenError("A layout has not been loaded yet.");a.shouldCheckEvents&&Object.keys(c.keyStatus).forEach((function(e){if(c.keyStatus[e].pressed&&null!==c.keyStatus[e].timestamp){var n=performance.now()-c.keyStatus[e].timestamp;if(!(n<500)){if(null===c.keys)throw new s.WhenError("A layout has not been loaded yet.");for(var i={shift:c.keys.shift.some((function(e){return c.keyStatus[e].pressed})),alt:c.keys.alt.some((function(e){return c.keyStatus[e].pressed})),ctrl:c.keys.ctrl.some((function(e){return c.keyStatus[e].pressed})),meta:c.keys.meta.some((function(e){return c.keyStatus[e].pressed}))},r=null,o=t.eventHistory.length-1;o>=0;o--){var a=t.eventHistory[o];if(a.timestamp<c.keyStatus[e].timestamp)break;if(a.key===e&&"held"===a.type&&a.modifiers.shift===i.shift&&a.modifiers.ctrl===i.ctrl&&a.modifiers.alt===i.alt&&a.modifiers.meta===i.meta){r=o;break}}null!==r?(t.eventHistory[r].duration=n,(0,t.emitEvent)()):(0,t.emitEvent)({type:"held",key:e,identifier:"",rawIdentifier:"",duration:n,timestamp:performance.now(),modifiers:i})}}})),setTimeout(e,a.heldInterval)}()},792:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.newGroup=t.groups=void 0;var i=n(85);t.groups=[],t.newGroup=function(e){if(!1===Array.isArray(e))throw new i.WhenError("When.newGroup() expects to receive an array of shortcuts as its first and only argument, but a ["+typeof e+"] was provided.");return{shortcuts:e,remove:function(){e.forEach((function(e){return e.remove()}))},pause:function(){e.forEach((function(e){return e.pause()}))},unpause:function(){e.forEach((function(e){return e.unpause()}))},toggle:function(){e.forEach((function(e){return e.toggle()}))},trigger:function(){e.forEach((function(e){return e.trigger()}))}}}},761:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,r)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.loadLayout=t.validateKeyName=t.keyToString=t.keyStatus=t.keyGroups=t.modifierKeys=t.keys=t.layouts=void 0;var o=n(85),a=s(n(399));t.layouts={qwerty:a},t.keys=null,t.modifierKeys=null,t.keyGroups=null,t.keyStatus={};var u=null;t.keyToString=function(e){var n=[];for(var i in t.keys)t.keys[i].includes(e)&&n.push(i);return n.reduce((function(e,t){return Math.min(e.length,t.length)?e:t}),n[0])||null},t.validateKeyName=function(e,n){if(null!==t.keys&&null!==u){if(!(e>="0"||e<="9"||void 0!==t.keys[e])){var i=u(e);if(i)throw new o.WhenError("".concat(i),n)}}else console.log("validateKeyName() was called before a layout was loaded")},t.loadLayout=function(e){var n=t.layouts[e];if(!n)throw new o.WhenError("Attempted to load non-existant layout: "+e);t.keys=n.keys,u=n.keySuggestions,t.modifierKeys=n.modifierKeys.flat(),t.keyGroups=n.keyGroups,t.keyStatus={},Object.keys(t.keys).forEach((function(e){t.keys[e].forEach((function(e){t.keyStatus[e]={pressed:!1,timestamp:null}}))}))}},399:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.keyGroups=t.modifierKeys=t.keySuggestions=t.keys=void 0;var i=n(807);t.keys={ctrl:["ControlLeft","ControlRight"],alt:["AltLeft","AltRight"],shift:["ShiftLeft","ShiftRight"],meta:["MetaLeft","MetaRight"],escape:["Escape"],f1:["F1"],f2:["F2"],f3:["F3"],f4:["F4"],f5:["F5"],f6:["F6"],f7:["F7"],f8:["F8"],f9:["F9"],f10:["F10"],f11:["F11"],f12:["F12"],f13:["F13"],f14:["F14"],f15:["F15"],f16:["F16"],f17:["F17"],f18:["F18"],f19:["F19"],"`":["Backquote"],"~":["Backquote"],grave_accent:["Backquote"],tilde:["Backquote"],num1:["Digit1"],num2:["Digit2"],num3:["Digit3"],num4:["Digit4"],num5:["Digit5"],num6:["Digit6"],num7:["Digit7"],num8:["Digit8"],num9:["Digit9"],num0:["Digit0"],_:["Minus"],hyphen:["Minus"],underscore:["Minus"],"=":["Equal"],plus:["Equal"],equals:["Equal"],backspace:["Backspace"],tab:["Tab"],caps_lock:["CapsLock"],space:["Space"],"[":["BracketLeft"],"{":["BracketLeft"],left_square_bracket:["BracketLeft"],left_curly_bracket:["BracketLeft"],"]":["BracketRight"],"}":["BracketRight"],right_square_bracket:["BracketRight"],right_curly_bracket:["BracketRight"],"\\":["Backslash"],"|":["Backslash"],backslash:["Backslash"],pipe:["Backslash"],";":["Semicolon"],":":["Semicolon"],colon:["Semicolon"],semicolon:["Semicolon"],"'":["Quote"],'"':["Quote"],apostrophe:["Quote"],quote:["Quote"],",":["Comma"],"<":["Comma"],comma:["Comma"],less_than:["Comma"],">":["Period"],period:["Period"],greater_than:["Period"],"?":["Slash"],forward_slash:["Slash"],question_mark:["Slash"],enter:["Enter"],insert:["Insert"],home:["Home"],page_up:["PageUp"],delete:["Delete"],end:["End"],page_down:["PageDown"],arrow_up:["ArrowUp"],up:["ArrowUp"],arrow_right:["ArrowRight"],right:["ArrowRight"],arrow_down:["ArrowDown"],down:["ArrowDown"],arrow_left:["ArrowLeft"],left:["ArrowLeft"],num_lock:["NumLock"],numpad_divide:["NumpadDivide"],numpad_multiply:["NumpadMultiply"],numpad_subtract:["NumpadSubtract"],numpad_add:["NumpadAdd"],numpad_enter:["NumpadEnter"],numpad_decimal:["NumpadDecimal"],numpad0:["Numpad0"],numpad1:["Numpad1"],numpad2:["Numpad2"],numpad3:["Numpad3"],numpad4:["Numpad4"],numpad5:["Numpad5"],numpad6:["Numpad6"],numpad7:["Numpad7"],numpad8:["Numpad8"],numpad9:["Numpad9"],a:["KeyA"],b:["KeyB"],c:["KeyC"],d:["KeyD"],e:["KeyE"],f:["KeyF"],g:["KeyG"],h:["KeyH"],i:["KeyI"],j:["KeyJ"],k:["KeyK"],l:["KeyL"],m:["KeyM"],n:["KeyN"],o:["KeyO"],p:["KeyP"],q:["KeyQ"],r:["KeyR"],s:["KeyS"],t:["KeyT"],u:["KeyU"],v:["KeyV"],w:["KeyW"],x:["KeyX"],y:["KeyY"],z:["KeyZ"]},i.isFirefox?t.keys.insert=["Help"]:i.isEdge||i.isEdgeChromium||i.isIE||i.isOpera||i.isChrome,t.keySuggestions=function(e){switch(e){case".":return'Instead of ".", you must use either "period" or "numpad_decimal", as these are interpreted as two different keys';case"-":return'Instead of "-", you must either use "hyphen" or "numpad_subtract", as these are interpreted as two different keys';case"/":return'Instead of "/", you must either use "forward_slash" or "numpad_divide", as these are interpreted as two different keys';case"*":return'Instead of "*", you must use numpad_multiply, unless you meant to use "num8"';case"+":return'Instead of "+", you must use numpad_add, unless you meant to use "="';case"!":case"@":case"#":case"$":case"%":case"^":case"&":case"(":case")":return'The character "'.concat(e,'" is not recognized, you probably meant to use the other ')+"character on that key";default:return'Unrecognized key identifier "'.concat(e,'"')}},t.modifierKeys=[t.keys.alt,t.keys.ctrl,t.keys.meta,t.keys.shift],t.keyGroups={arrowKeys:["arrow_up","arrow_right","arrow_down","arrow_left"],fKeys:["f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","f13","f14","f15","f16","f17","f18","f19"],letters:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],numbers:["1","2","3","4","5","6","7","8","9","0"]}},383:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearMode=t.setMode=t.currentMode=void 0;var i=n(85);t.currentMode=null,t.setMode=function(e){if("string"!=typeof e)throw new i.WhenError("When.setMode did not receive a string its first argument, received: "+typeof e);t.currentMode=e},t.clearMode=function(){t.currentMode=null}},296:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateFocusTarget=t.setFocus=t.focusedElement=t.focusHandlers=void 0;var i=n(85);t.focusHandlers=[],t.focusedElement=null,t.setFocus=function(e){if(!e||e instanceof HTMLElement==0)throw new i.WhenError("When.setFocus() was not provided an HTMLElement as its first argument, received: "+typeof e);if(!1===e.classList.contains("when-focus"))throw new i.WhenError('When.setFocus() was provided an HTMLElement that did not have the "when-focus" class.');var n=t.focusedElement;t.focusedElement=e,t.focusedElement!==n&&t.focusHandlers.forEach((function(e){return e(t.focusedElement,n)}))},window.addEventListener("mousedown",(function(e){if(null!==e.target){var n=t.focusedElement,i=e.target;if(i.classList&&i.classList.contains("when-focus"))t.focusedElement=i;else{for(t.focusedElement=i.parentNode;t.focusedElement&&t.focusedElement.classList&&!t.focusedElement.classList.contains("when-focus");)t.focusedElement=t.focusedElement.parentNode;t.focusedElement&&t.focusedElement.classList||(t.focusedElement=null)}t.focusedElement!==n&&t.focusHandlers.forEach((function(e){return e(t.focusedElement,n)}))}})),t.validateFocusTarget=function(e){var t=0===e.indexOf("id:"),n=0===e.indexOf("class:"),i=0===e.indexOf("#"),r=0===e.indexOf(".");return t||n||i||r}},86:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkEventMatch=void 0;var i=n(85);t.checkEventMatch=function(e,t){if(e.key!==t.key||e.type!==t.type)return!1;if(e.modifiers.shift!==t.modifiers.shift||e.modifiers.meta!==t.modifiers.meta||e.modifiers.alt!==t.modifiers.alt||e.modifiers.ctrl!==t.modifiers.ctrl)return!1;if("held"===e.type){if(void 0===t.duration||void 0===e.duration)throw new i.WhenError('"held" event had undefined "duration" property');return!(t.duration<e.duration)}return!0}},664:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createCombinationString=void 0;var i=n(761);t.createCombinationString=function(e){var t=e.timeline.map((function(e){var t=e.modifiers,n=t.alt,r=t.ctrl,s=t.meta,o=t.shift,a="".concat(n?"alt+":"").concat(r?"ctrl+":"").concat(s?"meta+":"").concat(o?"shift+":"");switch(e.type){case"pressed":return", ↓".concat(a).concat((0,i.keyToString)(e.key));case"released":return", ↑".concat(a).concat((0,i.keyToString)(e.key));case"held":return" (hold ".concat(e.duration/1e3,"s)")}})).join("").slice(2);if(e.timeConstraint)if(e.timeConstraint<1e3){var n=e.timeConstraint;t+=" (within ".concat(n,"ms)")}else{var r=(e.timeConstraint/1e3).toFixed(2);t+=" (within ".concat(r,"s)")}return t}},85:function(e,t){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.warnAboutChainOrder=t.warn=t.setQuiet=t.quiet=t.WhenError=void 0;var r=function(e){function t(t,n){var i=this;return n&&(t+="\n\nLast succesful chain call: ".concat(n.lastCalledFunctionName)),(i=e.call(this,t)||this).name="WhenError",i.whenData=n||null,i}return i(t,e),t}(Error);t.WhenError=r,t.quiet=!1,t.setQuiet=function(){t.quiet=!0},t.warn=function(e,n){t.quiet||(e="WhenWarning: "+e,n&&(e+="\n\nLast succesful chain call: ".concat(n.lastCalledFunctionName)),console.warn(e),console.trace())},t.warnAboutChainOrder=function(e,n,i){i.includes(n.lastCalledFunctionName)||(0,t.warn)(e+" should not be called after "+n.lastCalledFunctionName+", though it may still work as intended.",n)}},114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateEventKeyString=void 0,t.generateEventKeyString=function(e){var t=e.modifiers,n=t.alt,i=t.ctrl,r=t.meta,s=t.shift;return"".concat(n?"alt":"").concat(i?"ctrl":"").concat(r?"meta":"").concat(s?"shift":"").concat(e.key)}},738:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveElement=void 0,t.getActiveElement=function(){return null===document.activeElement?null:function e(t){if(null!==(null==t?void 0:t.shadowRoot)){var n=t.shadowRoot.activeElement;return n?e(n):null}return t}(document.activeElement)}},658:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyFromIdentifier=void 0;var i=n(85);t.getKeyFromIdentifier=function(e,t){var n=e.split("+").filter((function(e){return!["shift","alt","ctrl","meta"].includes(e)}));if(n.length>1)throw new i.WhenError("When: identifier for key contained more than one non-modifier key",t);return n[0]}},381:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getModifiersFromIdentifier=void 0,t.getModifiersFromIdentifier=function(e){var t=e.split("+");return{shift:t.includes("shift"),alt:t.includes("alt"),ctrl:t.includes("ctrl"),meta:t.includes("meta")}}},892:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shortcutFocusIsFulfilled=void 0;var i=n(296);t.shortcutFocusIsFulfilled=function(e){var t=e.focusTarget;if(null===t)return!0;if(null===i.focusedElement)return!1;if("string"!=typeof t)return t===i.focusedElement;if(t.includes("id:")||t.includes("#")){var n=t.replace("id:","").replace("#","");return i.focusedElement&&i.focusedElement.id===n}if(t.includes("class:")||t.includes(".")){var r=t.replace("class:","").replace(".","");return i.focusedElement&&i.focusedElement.classList&&i.focusedElement.classList.contains(r)}}},563:function(e,t,n){var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.heldInterval=t.shouldCheckEvents=t.When=t.commands=void 0;var r=n(761),s=n(472),o=n(296),a=n(85),u=n(383),c=n(792),d=n(780),l=n(658),h=n(381);function f(e){if(null===this.n)throw new a.WhenError("n value was null",this);var t=e*this.n;switch(this.nType){case"held":if(null===this.identifier)throw new a.WhenError("identifier value was null",this);var n=(0,l.getKeyFromIdentifier)(this.identifier,this);(0,r.validateKeyName)(n);var i=(0,h.getModifiersFromIdentifier)(this.identifier);if(null===r.keys)throw new a.WhenError("A layout has not been loaded yet.");if(t<500)throw new a.WhenError("Held events cannot have a hold duration of less than 500 milliseconds, but "+t+" were provided.",this);this.events.push({type:"pressed",key:r.keys[n.toLowerCase()][0],identifier:n.toLowerCase(),rawIdentifier:this.identifier,timestamp:0,modifiers:i}),this.events.push({type:"held",key:r.keys[n.toLowerCase()][0],identifier:n.toLowerCase(),rawIdentifier:this.identifier,timestamp:0,duration:t,modifiers:i}),this.eventsFromLastIdentifier=this.events.slice(this.events.length-2),this.identifier=null;break;case"constraint":if(null!==this.timeConstraint)throw new a.WhenError("Only one time constraint be placed on a shortcut.",this);this.timeConstraint=t}}function m(e){if(void 0!==e&&"string"!=typeof e&&!(e instanceof HTMLElement))throw new a.WhenError("When() must be passed either a string identifier for a key (optionally with modifiers), a string name for a command or an HTMLElement for focus related functionality.  Instead, a value of type ["+typeof e+"] was receieved: "+e);return{identifier:"string"!=typeof e?null:e,element:"string"==typeof e?null:e,events:[],timeConstraint:null,focusRequired:!1,focusTarget:null,mode:null,isCommand:!1,preventDefault:!1,n:null,nType:null,once:!1,inInput:!1,shortcut:null,lastCalledFunctionName:"When()",eventsFromLastIdentifier:null,IsInput:function(){var e=this;if((0,a.warnAboutChainOrder)("IsInput()",this,["When()","Then()"]),"string"!=typeof this.identifier)throw new a.WhenError("IsInput() must be called after a string key identifier sequence has been passed to When()/Then(), but currently the identifier is of type ["+typeof this.identifier+"]: "+this.identifier,this);var t=this.identifier.split(" ");return this.eventsFromLastIdentifier=[],t.forEach((function(t){var n=t.match(/id:[\w_-]+|class:[\w_-]+|\.[\w_-]+|#[\w_-]+/),i=t.match(/^\((\d+)(s|ms)\)$/);if(n){if(null!==e.focusTarget)throw new a.WhenError("Only one focus constraint be placed on a shortcut.",e);e.focusRequired=!0,e.focusTarget=t}else if(i){if(null!==e.timeConstraint)throw new a.WhenError("Only one time constraint be placed on a shortcut.",e);var s=Number(i[1])*("s"===i[2]?1e3:1);e.timeConstraint=s}else{if(null===r.keys)throw new a.WhenError("A layout has not been loaded yet.");var o=(0,l.getKeyFromIdentifier)(t,e),u=(0,h.getModifiersFromIdentifier)(t);(0,r.validateKeyName)(o,e),e.events.push({type:"pressed",key:r.keys[o.toLowerCase()][0],identifier:o.toLowerCase(),rawIdentifier:t,timestamp:0,modifiers:u}),null===e.eventsFromLastIdentifier&&(e.eventsFromLastIdentifier=[]),e.eventsFromLastIdentifier.push(e.events[e.events.length-1]),e.identifier=null}})),this.lastCalledFunctionName="IsInput()",this},Then:function(e){if((0,a.warnAboutChainOrder)("Then()",this,["When()","ModeIs()","IsFocused()","IsPressed()","IsReleased()","Seconds()","Milliseconds()","Times()"]),null!==this.identifier&&this.IsInput(),"string"!=typeof e)throw new a.WhenError("Then() must be called with a string key identifier (optionally with modifiers).",this);return this.identifier=e,this.eventsFromLastIdentifier=null,this.lastCalledFunctionName="Then()",this},ModeIs:function(e){if((0,a.warnAboutChainOrder)("ModeIs()",this,["When()"]),void 0===e)throw new a.WhenError("ModeIs() was called without a string argument.  A mode name is required as the first and only argument.",this);if("string"!=typeof e)throw new a.WhenError("ModeIs() was called with a ".concat(typeof e," argument instead of a string: ").concat(e),this);return this.mode=e,this.lastCalledFunctionName="ModeIs()",this},IsFocused:function(){if((0,a.warnAboutChainOrder)("IsFocused()",this,["When()"]),this.identifier){if(!(0,o.validateFocusTarget)(this.identifier))throw new a.WhenError('IsFocused() was called but the string identifier provided to When() was neither an "id:" or a "class:" selector',this)}else{if(!this.element)throw new a.WhenError('IsFocused() cannot be called until When() has received an HTMLElement or a "id:"/"class:" selector',this);this.element.classList&&this.element.classList.contains("when-focus")||(0,a.warn)('IsFocused() was called, but the element provided to When() did not have the "when-focus" class assigned to it.',this)}return this.focusRequired=!0,this.identifier?this.focusTarget=this.identifier:this.element&&(this.focusTarget=this.element),this.lastCalledFunctionName="IsFocused()",this},IsExecuted:function(){if((0,a.warnAboutChainOrder)("IsExecuted()",this,["When()"]),null===this.identifier)throw new a.WhenError("IsExecuted() cannot be called before a string command name has been passed to When().",this);return this.isCommand=!0,this.lastCalledFunctionName="IsExecuted()",this},IsPressed:function(){if((0,a.warnAboutChainOrder)("IsPressed()",this,["When()","Then()"]),null===this.identifier)throw new a.WhenError("IsPressed() cannot be called before a string key identifier has been passed to When() or Then()",this);if(null===r.keys)throw new a.WhenError("A layout has not been loaded yet.");var e=(0,l.getKeyFromIdentifier)(this.identifier,this);(0,r.validateKeyName)(e);var t=(0,h.getModifiersFromIdentifier)(this.identifier);return this.events.push({type:"pressed",key:r.keys[e.toLowerCase()][0],identifier:e.toLowerCase(),rawIdentifier:this.identifier,timestamp:0,modifiers:t}),null===this.eventsFromLastIdentifier&&(this.eventsFromLastIdentifier=[]),this.eventsFromLastIdentifier.push(this.events[this.events.length-1]),this.identifier=null,this.lastCalledFunctionName="IsPressed()",this},IsReleased:function(){if((0,a.warnAboutChainOrder)("IsReleased()",this,["When()","Then()"]),null===this.identifier)throw new a.WhenError("IsReleased() cannot be called before a string key identifier has been passed to When() or Then()",this);if(null===r.keys)throw new a.WhenError("A layout has not been loaded yet.");var e=(0,l.getKeyFromIdentifier)(this.identifier,this);(0,r.validateKeyName)(e);var t=(0,h.getModifiersFromIdentifier)(this.identifier);return this.events.push({type:"released",key:r.keys[e.toLowerCase()][0],identifier:e.toLowerCase(),rawIdentifier:this.identifier,timestamp:0,modifiers:t}),null===this.eventsFromLastIdentifier&&(this.eventsFromLastIdentifier=[]),this.eventsFromLastIdentifier.push(this.events[this.events.length-1]),this.identifier=null,this.lastCalledFunctionName="IsReleased()",this},IsHeldFor:function(e){if((0,a.warnAboutChainOrder)("IsHeldFor()",this,["When()","Then()"]),null===this.identifier)throw new a.WhenError("IsHeldFor() cannot be called before a string key identifier has been passed to When() or Then()",this);if("string"!=typeof e&&"number"!=typeof e||Number(e)<1)throw new a.WhenError('IsHeldFor() expects to receive a number greater than 0 or a string like "1s" or "1000ms", but received a value of type ['+typeof e+"]: "+e,this);if((0,r.validateKeyName)((0,l.getKeyFromIdentifier)(this.identifier,this)),this.nType="held",this.lastCalledFunctionName="IsHeldFor()","number"==typeof e)return this.n=e,this;var t=e.match(/(\d)(s|ms)/);if(null===t)throw new a.WhenError('IsHeldFor() received a string but it didn\'t match the template "1s" or "1000ms"',this);switch(this.n=Number(t[1]),t[2]){case"s":return this.Seconds();case"ms":return this.Milliseconds();default:throw new a.WhenError('IsHeldFor() received a string that did not contain "s" or "ms"',this)}},Within:function(e){if((0,a.warnAboutChainOrder)("Within()",this,["Then()","IsPressed()","IsReleased()","Seconds()","Milliseconds()","Times()"]),"string"!=typeof e&&"number"!=typeof e||Number(e)<1)throw new a.WhenError('Within() expects to receive a number greater than 0 or a string like "1s" or "1000ms", but received a value of type ['+typeof e+"]: "+e,this);if(this.nType="constraint",this.lastCalledFunctionName="Within()","number"==typeof e)return this.n=e,this;var t=e.match(/(\d)(s|ms)/);if(null===t)throw new a.WhenError('Within() received a string but it didn\'t match the template "1s" or "1000ms"',this);switch(this.n=Number(t[1]),t[2]){case"s":return this.Seconds();case"ms":return this.Milliseconds();default:throw new a.WhenError('Within() received a string that did not contain "s" or "ms"',this)}},Milliseconds:function(){if((0,a.warnAboutChainOrder)("Milliseconds()",this,["IsHeldFor()","Within()"]),!this.n)throw new a.WhenError("Milliseconds() cannot be called before a number greater than 0 has been passed to IsHeldFor() or Within()",this);return f.call(this,1),this.lastCalledFunctionName="Milliseconds()",this},Seconds:function(){if((0,a.warnAboutChainOrder)("Seconds()",this,["IsHeldFor()","Within()"]),!this.n)throw new a.WhenError("Seconds() cannot be called before a number greater than 0 has been passed to IsHeldFor() or Within()",this);return f.call(this,1e3),this.lastCalledFunctionName="Seconds()",this},Times:function(e){var t;if((0,a.warnAboutChainOrder)("Times()",this,["When()","Then()","IsPressed()","IsReleased()","Seconds()","Milliseconds()"]),"number"!=typeof e||e<2)throw new a.WhenError("Times() expects to receive a number greater than 1, ' +\n\t\t\t\t\t\t'but a ".concat(typeof e," value was received: ").concat(e),this);if(null!==this.identifier&&this.IsInput(),null===this.eventsFromLastIdentifier)throw new a.WhenError("Times() cannot be called if the current identifier hasn't registered any events yet",this);for(var n=0;n<e-1;n++)(t=this.events).push.apply(t,this.eventsFromLastIdentifier);return this.lastCalledFunctionName="Times()",this},Execute:function(e,n){(0,a.warnAboutChainOrder)("Execute()",this,["When()","Then()","IsPressed()","IsReleased()","Seconds()","Milliseconds()","PreventDefault()","IsInput()","Times()"]),null!==this.identifier&&this.IsInput();var o=typeof e;if("string"!==o&&"function"!==o)throw new a.WhenError("Execute() must be called with either a string command name or a handler function as the only argument, but a value of type ["+o+"] was received: "+e,this);if("string"==typeof e&&void 0===t.commands[e])throw new a.WhenError("Execute() was called with a command name not yet registered by a call to When([command_name]).IsExecuted().Run([function]): "+e,this);if(this.events.some((function(e){return e.identifier>="0"&&e.identifier<="9"}))){var u=this.events.map((function(e){return e.identifier>="0"&&e.identifier<="9"?i(i({},e),{identifier:"num"+e.identifier,key:r.keys["num"+e.identifier][0]}):e})),c=this.events.map((function(e){return e.identifier>="0"&&e.identifier<="9"?i(i({},e),{identifier:"numpad"+e.identifier,key:r.keys["numpad"+e.identifier][0]}):e}));return new s.Shortcut({timeline:c,command:"string"==typeof e?e:n||"",handler:"function"==typeof e?e:null,mode:this.mode,timeConstraint:this.timeConstraint,focusTarget:this.focusRequired?this.focusTarget:null}),this.lastCalledFunctionName="Execute()",new s.Shortcut({timeline:u,command:"string"==typeof e?e:n||"",handler:"function"==typeof e?e:null,mode:this.mode,timeConstraint:this.timeConstraint,focusTarget:this.focusRequired?this.focusTarget:null})}return this.lastCalledFunctionName="Execute()",new s.Shortcut({timeline:this.events,command:"string"==typeof e?e:n||"",handler:"function"==typeof e?e:null,mode:this.mode,timeConstraint:this.timeConstraint,focusTarget:this.focusRequired?this.focusTarget:null})},Run:function(e){if((0,a.warnAboutChainOrder)("Run()",this,["IsExecuted()"]),null===this.identifier)throw new a.WhenError("Run() cannot be called before a string key identifier has been passed to When().",this);if("function"!=typeof e)throw new a.WhenError("Run() must be called with a function as its first and only argument.",this);if(!this.isCommand)throw new a.WhenError("Run() must be called after a call to IsExecuted().",this);t.commands[this.identifier]=e,this.lastCalledFunctionName="Run()"}}}t.commands={},t.When=m,m.setMode=u.setMode,m.clearMode=u.clearMode,m.newGroup=c.newGroup,m.quiet=a.setQuiet,m.loadLayout=r.loadLayout,m.documentation=d.documentation,m.setFocus=o.setFocus,t.shouldCheckEvents=!0,m.toggle=function(){t.shouldCheckEvents=!t.shouldCheckEvents},m.pause=function(){t.shouldCheckEvents=!1},m.unpause=function(){t.shouldCheckEvents=!0},t.heldInterval=100,m.setHeldInterval=function(e){if("number"!=typeof e)throw new a.WhenError("When.setHeldInterval() expects to receive a numberic milliseconds value as the first an only argument, but a ["+typeof e+"] was provided.");t.heldInterval=e},m.focusChanges=function(e){if("function"!=typeof e)throw new a.WhenError("When.focusChanges() expects to receive a function as the first an only argument, but a ["+typeof e+"] was provided.");o.focusHandlers.push(e)},m.focusIs=function(e,t){if(!1===Array.isArray(t))throw new a.WhenError("When.focusIs() must receive an array of shortcuts as its second argument, "+"but a ".concat(typeof t," was received: ").concat(t));return e instanceof HTMLElement==1&&(e.classList&&e.classList.contains("when-focus")||(0,a.warn)('The element provided to When.focusIs() did not have the "when-focus" class assigned to it.')),t.forEach((function(t){t.focusTarget=e})),t},m.modeIs=function(e,t){if(!1===Array.isArray(t))throw new a.WhenError("When.modeIs() must receive an array of shortcuts as its second argument, "+"but a ".concat(typeof t," was received: ").concat(t));return t.forEach((function(t){t.mode=e})),t},m.command=function(e,n){if("string"!=typeof e)throw new a.WhenError("When.command did not receive a string command name as the first argument");if("function"!=typeof n)throw new a.WhenError("When.command did not receive a function as the second argument");t.commands[e]=n},m.keyGroups=function(){return r.keyGroups},m.loadLayout("qwerty")}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}var i={};return(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),n(242);var t=n(563);e.default=t.When,window.When=t.When})(),i})()));